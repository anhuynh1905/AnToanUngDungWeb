{"ast":null,"code":"var _jsxFileName = \"D:\\\\HK3-N2\\\\ANTOANHETHONGWEB\\\\BT5\\\\frontend\\\\src\\\\pages\\\\BookManagementPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\n// Import API functions (KHÔNG cần getCategories ở đây nữa)\nimport { getBooks, createBook, updateBook, deleteBook } from '../services/api';\n// Import Auth context hook\nimport { useAuth } from '../contexts/AuthContext';\n// Import the updated BookForm component (đảm bảo đường dẫn đúng)\nimport BookForm from '../components/BookForm'; // Giả sử bạn đặt BookForm trong thư mục components\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction BookManagementPage() {\n  _s();\n  // State for data lists\n  const [books, setBooks] = useState([]); // Chỉ cần state cho books\n\n  // State for UI control\n  const [loading, setLoading] = useState(true); // Loading dữ liệu ban đầu\n  const [error, setError] = useState(''); // Lỗi chung của trang (fetch, delete)\n  const {\n    logout\n  } = useAuth(); // Lấy hàm logout từ context\n\n  // State related to the BookForm\n  const [editingBook, setEditingBook] = useState(null); // Sách đang được sửa (null = thêm mới)\n  const [showForm, setShowForm] = useState(false); // Ẩn/hiện form\n  const [formLoading, setFormLoading] = useState(false); // Loading khi submit form\n  const [formError, setFormError] = useState(''); // Lỗi trả về từ API khi submit form\n\n  // State for delete button loading indicator\n  const [deleteLoading, setDeleteLoading] = useState(null); // ID sách đang được xóa\n\n  // --- Fetch initial data (CHỈ fetch books) ---\n  const fetchData = useCallback(async () => {\n    setLoading(true);\n    setError('');\n    console.log(\"BookManagementPage: Fetching books...\");\n    try {\n      // Chỉ cần gọi getBooks\n      const booksResponse = await getBooks();\n      setBooks(booksResponse.data || []); // Đảm bảo books là mảng\n      console.log(\"BookManagementPage: Books fetched successfully.\", booksResponse.data);\n    } catch (err) {\n      console.error(\"BookManagementPage: Failed to fetch books:\", err);\n      if (err.response && (err.response.status === 401 || err.response.status === 403)) {\n        setError('Access denied or session expired. Please log in with appropriate permissions.');\n        // Cân nhắc gọi logout hoặc chuyển hướng người dùng ở đây\n        // setTimeout(logout, 3000);\n      } else {\n        setError('Failed to load book data. Please try refreshing the page.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [logout]); // logout là dependency nếu bạn dùng nó trong catch\n\n  // Fetch data khi component mount lần đầu\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  // --- Form Visibility Handlers ---\n  const handleShowAddForm = () => {\n    setEditingBook(null); // Đảm bảo form ở chế độ thêm mới\n    setShowForm(true);\n    setFormError(''); // Xóa lỗi form cũ\n    window.scrollTo(0, 0); // Cuộn lên đầu để thấy form\n  };\n  const handleEditClick = book => {\n    console.log(\"BookManagementPage: Editing book:\", book);\n    setEditingBook(book); // Đặt sách cần sửa\n    setShowForm(true);\n    setFormError('');\n    window.scrollTo(0, 0);\n  };\n  const handleCancelEdit = () => {\n    setEditingBook(null);\n    setShowForm(false);\n    setFormError('');\n    console.log(\"BookManagementPage: Cancelled edit.\");\n  };\n\n  // --- Form Submission Handler ---\n  // Nhận 'payload' đã được chuẩn bị bởi BookForm (chứa category_id)\n  const handleFormSubmit = async payload => {\n    setFormLoading(true);\n    setFormError('');\n    console.log(`BookManagementPage: Submitting form data (Edit mode: ${!!editingBook})`, payload);\n    try {\n      let message = '';\n      if (editingBook) {\n        // --- Update ---\n        console.log(`BookManagementPage: Calling updateBook API for ID: ${editingBook.id}`);\n        await updateBook(editingBook.id, payload);\n        message = 'Book updated successfully!';\n      } else {\n        // --- Create ---\n        console.log(`BookManagementPage: Calling createBook API`);\n        await createBook(payload);\n        message = 'Book created successfully!';\n      }\n      alert(message); // Thông báo thành công\n      // Reset UI và tải lại dữ liệu\n      setShowForm(false);\n      setEditingBook(null);\n      fetchData(); // Gọi lại fetchData để cập nhật danh sách\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(`BookManagementPage: Failed to ${editingBook ? 'update' : 'create'} book:`, err);\n      // Hiển thị lỗi từ API\n      setFormError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || `An error occurred while ${editingBook ? 'updating' : 'creating'} the book.`);\n    } finally {\n      setFormLoading(false); // Kết thúc loading form\n    }\n  };\n\n  // --- Delete Handler ---\n  const handleDeleteBook = async (bookId, bookTitle) => {\n    setDeleteLoading(bookId); // Bắt đầu loading cho nút delete này\n    setError(''); // Xóa lỗi chung cũ\n    console.log(`BookManagementPage: Attempting to delete book ID: ${bookId}, Title: ${bookTitle}`);\n\n    // Xác nhận người dùng\n    if (!window.confirm(`Are you sure you want to delete the book: \"${bookTitle}\"? This action cannot be undone.`)) {\n      setDeleteLoading(null); // Hủy loading nếu người dùng cancel\n      console.log(\"BookManagementPage: Delete cancelled by user.\");\n      return;\n    }\n    try {\n      await deleteBook(bookId); // Gọi API delete\n      alert(`Book \"${bookTitle}\" deleted successfully!`);\n      fetchData(); // Tải lại danh sách sách sau khi xóa\n    } catch (err) {\n      console.error(`BookManagementPage: Failed to delete book ID ${bookId}:`, err);\n      // Xử lý lỗi cụ thể (ví dụ: conflict do sách đang được mượn)\n      if (err.response && err.response.status === 409) {\n        setError(err.response.data.message || `Cannot delete \"${bookTitle}\" as it might be referenced elsewhere (e.g., in active borrows).`);\n      } else {\n        var _err$response2, _err$response2$data;\n        // Lỗi chung khác\n        setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || `Failed to delete book \"${bookTitle}\". Please try again.`);\n      }\n    } finally {\n      setDeleteLoading(null); // Kết thúc loading cho nút delete này\n    }\n  };\n\n  // --- UI Rendering ---\n  // Hiển thị loading nếu dữ liệu ban đầu chưa sẵn sàng\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"Loading Book Data...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 25\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Book Management\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 23\n    }, this), !showForm && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleShowAddForm,\n      style: {\n        marginBottom: '20px'\n      },\n      children: \"+ Add New Book\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 18\n    }, this), showForm && /*#__PURE__*/_jsxDEV(BookForm, {\n      book: editingBook,\n      onSubmit: handleFormSubmit,\n      onCancel: handleCancelEdit,\n      loading: formLoading,\n      error: formError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Existing Books\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }, this), books.length === 0 && !loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No books found. Use the button above to add one!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"table\", {\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"ID\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Author\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Qty\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Price\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: books.map(book => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: book.id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: book.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: book.author || 'N/A'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: book.category_name || 'N/A'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: book.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: book.price != null ? `$${Number(book.price).toFixed(2)}` : 'N/A'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"secondary\",\n              onClick: () => handleEditClick(book)\n              // Disable nút khi đang xóa sách này HOẶC đang submit form\n              ,\n              disabled: deleteLoading === book.id || formLoading,\n              style: {\n                marginRight: '5px'\n              },\n              children: \"Edit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"danger\",\n              onClick: () => handleDeleteBook(book.id, book.title)\n              // Disable nút khi đang xóa sách này HOẶC đang submit form\n              ,\n              disabled: deleteLoading === book.id || formLoading,\n              children: deleteLoading === book.id ? 'Deleting...' : 'Delete'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 33\n          }, this)]\n        }, book.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      jsx: true,\n      children: `\n              table { width: 100%; border-collapse: collapse; margin-top: 15px; }\n              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; vertical-align: middle;}\n              th { background-color: #f2f2f2; font-weight: bold; }\n              tr:nth-child(even) { background-color: #f9f9f9; }\n              td button { padding: 5px 10px; font-size: 0.9em;}\n            `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 9\n  }, this);\n}\n_s(BookManagementPage, \"rGwC6w+fygZ3ws7jC+Pyi3cmmoI=\", false, function () {\n  return [useAuth];\n});\n_c = BookManagementPage;\nexport default BookManagementPage;\nvar _c;\n$RefreshReg$(_c, \"BookManagementPage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","getBooks","createBook","updateBook","deleteBook","useAuth","BookForm","jsxDEV","_jsxDEV","BookManagementPage","_s","books","setBooks","loading","setLoading","error","setError","logout","editingBook","setEditingBook","showForm","setShowForm","formLoading","setFormLoading","formError","setFormError","deleteLoading","setDeleteLoading","fetchData","console","log","booksResponse","data","err","response","status","handleShowAddForm","window","scrollTo","handleEditClick","book","handleCancelEdit","handleFormSubmit","payload","message","id","alert","_err$response","_err$response$data","handleDeleteBook","bookId","bookTitle","confirm","_err$response2","_err$response2$data","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","style","marginBottom","onSubmit","onCancel","length","map","title","author","category_name","quantity","price","Number","toFixed","disabled","marginRight","jsx","_c","$RefreshReg$"],"sources":["D:/HK3-N2/ANTOANHETHONGWEB/BT5/frontend/src/pages/BookManagementPage.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\n// Import API functions (KHÔNG cần getCategories ở đây nữa)\r\nimport { getBooks, createBook, updateBook, deleteBook } from '../services/api';\r\n// Import Auth context hook\r\nimport { useAuth } from '../contexts/AuthContext';\r\n// Import the updated BookForm component (đảm bảo đường dẫn đúng)\r\nimport BookForm from '../components/BookForm'; // Giả sử bạn đặt BookForm trong thư mục components\r\n\r\nfunction BookManagementPage() {\r\n    // State for data lists\r\n    const [books, setBooks] = useState([]); // Chỉ cần state cho books\r\n\r\n    // State for UI control\r\n    const [loading, setLoading] = useState(true); // Loading dữ liệu ban đầu\r\n    const [error, setError] = useState(''); // Lỗi chung của trang (fetch, delete)\r\n    const { logout } = useAuth(); // Lấy hàm logout từ context\r\n\r\n    // State related to the BookForm\r\n    const [editingBook, setEditingBook] = useState(null); // Sách đang được sửa (null = thêm mới)\r\n    const [showForm, setShowForm] = useState(false);    // Ẩn/hiện form\r\n    const [formLoading, setFormLoading] = useState(false); // Loading khi submit form\r\n    const [formError, setFormError] = useState('');   // Lỗi trả về từ API khi submit form\r\n\r\n    // State for delete button loading indicator\r\n    const [deleteLoading, setDeleteLoading] = useState(null); // ID sách đang được xóa\r\n\r\n\r\n    // --- Fetch initial data (CHỈ fetch books) ---\r\n    const fetchData = useCallback(async () => {\r\n        setLoading(true);\r\n        setError('');\r\n        console.log(\"BookManagementPage: Fetching books...\");\r\n        try {\r\n            // Chỉ cần gọi getBooks\r\n            const booksResponse = await getBooks();\r\n            setBooks(booksResponse.data || []); // Đảm bảo books là mảng\r\n            console.log(\"BookManagementPage: Books fetched successfully.\", booksResponse.data);\r\n        } catch (err) {\r\n            console.error(\"BookManagementPage: Failed to fetch books:\", err);\r\n             if (err.response && (err.response.status === 401 || err.response.status === 403)) {\r\n                setError('Access denied or session expired. Please log in with appropriate permissions.');\r\n                // Cân nhắc gọi logout hoặc chuyển hướng người dùng ở đây\r\n                // setTimeout(logout, 3000);\r\n             } else {\r\n                 setError('Failed to load book data. Please try refreshing the page.');\r\n             }\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [logout]); // logout là dependency nếu bạn dùng nó trong catch\r\n\r\n    // Fetch data khi component mount lần đầu\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, [fetchData]);\r\n\r\n    // --- Form Visibility Handlers ---\r\n    const handleShowAddForm = () => {\r\n        setEditingBook(null); // Đảm bảo form ở chế độ thêm mới\r\n        setShowForm(true);\r\n        setFormError(''); // Xóa lỗi form cũ\r\n        window.scrollTo(0, 0); // Cuộn lên đầu để thấy form\r\n    };\r\n\r\n    const handleEditClick = (book) => {\r\n        console.log(\"BookManagementPage: Editing book:\", book);\r\n        setEditingBook(book); // Đặt sách cần sửa\r\n        setShowForm(true);\r\n        setFormError('');\r\n        window.scrollTo(0, 0);\r\n    };\r\n\r\n    const handleCancelEdit = () => {\r\n        setEditingBook(null);\r\n        setShowForm(false);\r\n        setFormError('');\r\n        console.log(\"BookManagementPage: Cancelled edit.\");\r\n    };\r\n\r\n    // --- Form Submission Handler ---\r\n    // Nhận 'payload' đã được chuẩn bị bởi BookForm (chứa category_id)\r\n    const handleFormSubmit = async (payload) => {\r\n        setFormLoading(true);\r\n        setFormError('');\r\n        console.log(`BookManagementPage: Submitting form data (Edit mode: ${!!editingBook})`, payload);\r\n        try {\r\n            let message = '';\r\n            if (editingBook) {\r\n                // --- Update ---\r\n                console.log(`BookManagementPage: Calling updateBook API for ID: ${editingBook.id}`);\r\n                await updateBook(editingBook.id, payload);\r\n                message = 'Book updated successfully!';\r\n            } else {\r\n                // --- Create ---\r\n                console.log(`BookManagementPage: Calling createBook API`);\r\n                await createBook(payload);\r\n                message = 'Book created successfully!';\r\n            }\r\n            alert(message); // Thông báo thành công\r\n            // Reset UI và tải lại dữ liệu\r\n            setShowForm(false);\r\n            setEditingBook(null);\r\n            fetchData(); // Gọi lại fetchData để cập nhật danh sách\r\n        } catch (err) {\r\n            console.error(`BookManagementPage: Failed to ${editingBook ? 'update' : 'create'} book:`, err);\r\n            // Hiển thị lỗi từ API\r\n            setFormError(err.response?.data?.message || `An error occurred while ${editingBook ? 'updating' : 'creating'} the book.`);\r\n        } finally {\r\n            setFormLoading(false); // Kết thúc loading form\r\n        }\r\n    };\r\n\r\n     // --- Delete Handler ---\r\n    const handleDeleteBook = async (bookId, bookTitle) => {\r\n        setDeleteLoading(bookId); // Bắt đầu loading cho nút delete này\r\n        setError(''); // Xóa lỗi chung cũ\r\n        console.log(`BookManagementPage: Attempting to delete book ID: ${bookId}, Title: ${bookTitle}`);\r\n\r\n        // Xác nhận người dùng\r\n        if (!window.confirm(`Are you sure you want to delete the book: \"${bookTitle}\"? This action cannot be undone.`)) {\r\n            setDeleteLoading(null); // Hủy loading nếu người dùng cancel\r\n            console.log(\"BookManagementPage: Delete cancelled by user.\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await deleteBook(bookId); // Gọi API delete\r\n            alert(`Book \"${bookTitle}\" deleted successfully!`);\r\n            fetchData(); // Tải lại danh sách sách sau khi xóa\r\n        } catch (err) {\r\n             console.error(`BookManagementPage: Failed to delete book ID ${bookId}:`, err);\r\n             // Xử lý lỗi cụ thể (ví dụ: conflict do sách đang được mượn)\r\n             if (err.response && err.response.status === 409) {\r\n                  setError(err.response.data.message || `Cannot delete \"${bookTitle}\" as it might be referenced elsewhere (e.g., in active borrows).`);\r\n             } else {\r\n                  // Lỗi chung khác\r\n                  setError(err.response?.data?.message || `Failed to delete book \"${bookTitle}\". Please try again.`);\r\n             }\r\n        } finally {\r\n            setDeleteLoading(null); // Kết thúc loading cho nút delete này\r\n        }\r\n    };\r\n\r\n\r\n    // --- UI Rendering ---\r\n    // Hiển thị loading nếu dữ liệu ban đầu chưa sẵn sàng\r\n    if (loading) return <div className=\"loading\">Loading Book Data...</div>;\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <h2>Book Management</h2>\r\n            {/* Hiển thị lỗi fetch hoặc delete (nếu có) */}\r\n            {error && <p className=\"error-message\">{error}</p>}\r\n\r\n            {/* Nút để mở form thêm mới, chỉ hiển thị khi form đang ẩn */}\r\n            {!showForm && (\r\n                 <button onClick={handleShowAddForm} style={{ marginBottom: '20px' }}>+ Add New Book</button>\r\n            )}\r\n\r\n            {/* Component BookForm: hiển thị khi showForm là true */}\r\n            {/* Truyền các props cần thiết:\r\n                - book: dữ liệu sách đang sửa (null nếu thêm mới)\r\n                - onSubmit: hàm xử lý khi form submit (đã bao gồm payload chuẩn)\r\n                - onCancel: hàm xử lý khi hủy edit\r\n                - loading: trạng thái loading của việc submit form\r\n                - error: lỗi trả về từ API khi submit form trước đó\r\n                - KHÔNG truyền prop 'categories' nữa\r\n            */}\r\n            {showForm && (\r\n                <BookForm\r\n                    book={editingBook}\r\n                    onSubmit={handleFormSubmit}\r\n                    onCancel={handleCancelEdit}\r\n                    loading={formLoading}\r\n                    error={formError}\r\n                 />\r\n            )}\r\n\r\n            {/* --- Danh sách Sách hiện có --- */}\r\n            <h3>Existing Books</h3>\r\n            {books.length === 0 && !loading ? (\r\n                <p>No books found. Use the button above to add one!</p>\r\n            ) : (\r\n                <table>\r\n                    {/* Phần đầu bảng */}\r\n                    <thead>\r\n                        <tr>\r\n                            <th>ID</th>\r\n                            <th>Title</th>\r\n                            <th>Author</th>\r\n                            <th>Category</th>\r\n                            <th>Qty</th>\r\n                            <th>Price</th>\r\n                            <th>Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    {/* Phần thân bảng */}\r\n                    <tbody>\r\n                        {/* Lặp qua danh sách sách */}\r\n                        {books.map(book => (\r\n                            <tr key={book.id}>\r\n                                <td>{book.id}</td>\r\n                                <td>{book.title}</td>\r\n                                <td>{book.author || 'N/A'}</td>\r\n                                {/* Giả định backend trả về category_name khi GET /books */}\r\n                                <td>{book.category_name || 'N/A'}</td>\r\n                                <td>{book.quantity}</td>\r\n                                {/* Định dạng giá tiền */}\r\n                                <td>{book.price != null ? `$${Number(book.price).toFixed(2)}` : 'N/A'}</td>\r\n                                <td>\r\n                                    {/* Nút Edit */}\r\n                                    <button\r\n                                        className=\"secondary\"\r\n                                        onClick={() => handleEditClick(book)}\r\n                                        // Disable nút khi đang xóa sách này HOẶC đang submit form\r\n                                        disabled={deleteLoading === book.id || formLoading}\r\n                                        style={{ marginRight: '5px' }}\r\n                                    >\r\n                                        Edit\r\n                                    </button>\r\n                                    {/* Nút Delete */}\r\n                                    <button\r\n                                        className=\"danger\"\r\n                                        onClick={() => handleDeleteBook(book.id, book.title)}\r\n                                        // Disable nút khi đang xóa sách này HOẶC đang submit form\r\n                                        disabled={deleteLoading === book.id || formLoading}\r\n                                    >\r\n                                        {/* Hiển thị chữ khác khi đang loading delete */}\r\n                                        {deleteLoading === book.id ? 'Deleting...' : 'Delete'}\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            )}\r\n            {/* CSS cho bảng (giống như trước) */}\r\n            <style jsx>{`\r\n              table { width: 100%; border-collapse: collapse; margin-top: 15px; }\r\n              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; vertical-align: middle;}\r\n              th { background-color: #f2f2f2; font-weight: bold; }\r\n              tr:nth-child(even) { background-color: #f9f9f9; }\r\n              td button { padding: 5px 10px; font-size: 0.9em;}\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default BookManagementPage;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC/D;AACA,SAASC,QAAQ,EAAEC,UAAU,EAAEC,UAAU,EAAEC,UAAU,QAAQ,iBAAiB;AAC9E;AACA,SAASC,OAAO,QAAQ,yBAAyB;AACjD;AACA,OAAOC,QAAQ,MAAM,wBAAwB,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE/C,SAASC,kBAAkBA,CAAA,EAAG;EAAAC,EAAA;EAC1B;EACA,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;;EAExC;EACA,MAAM,CAACe,OAAO,EAAEC,UAAU,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EAC9C,MAAM,CAACiB,KAAK,EAAEC,QAAQ,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EACxC,MAAM;IAAEmB;EAAO,CAAC,GAAGZ,OAAO,CAAC,CAAC,CAAC,CAAC;;EAE9B;EACA,MAAM,CAACa,WAAW,EAAEC,cAAc,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EACtD,MAAM,CAACsB,QAAQ,EAAEC,WAAW,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAI;EACpD,MAAM,CAACwB,WAAW,EAAEC,cAAc,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;EACvD,MAAM,CAAC0B,SAAS,EAAEC,YAAY,CAAC,GAAG3B,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAG;;EAElD;EACA,MAAM,CAAC4B,aAAa,EAAEC,gBAAgB,CAAC,GAAG7B,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;;EAG1D;EACA,MAAM8B,SAAS,GAAG5B,WAAW,CAAC,YAAY;IACtCc,UAAU,CAAC,IAAI,CAAC;IAChBE,QAAQ,CAAC,EAAE,CAAC;IACZa,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;IACpD,IAAI;MACA;MACA,MAAMC,aAAa,GAAG,MAAM9B,QAAQ,CAAC,CAAC;MACtCW,QAAQ,CAACmB,aAAa,CAACC,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC;MACpCH,OAAO,CAACC,GAAG,CAAC,iDAAiD,EAAEC,aAAa,CAACC,IAAI,CAAC;IACtF,CAAC,CAAC,OAAOC,GAAG,EAAE;MACVJ,OAAO,CAACd,KAAK,CAAC,4CAA4C,EAAEkB,GAAG,CAAC;MAC/D,IAAIA,GAAG,CAACC,QAAQ,KAAKD,GAAG,CAACC,QAAQ,CAACC,MAAM,KAAK,GAAG,IAAIF,GAAG,CAACC,QAAQ,CAACC,MAAM,KAAK,GAAG,CAAC,EAAE;QAC/EnB,QAAQ,CAAC,+EAA+E,CAAC;QACzF;QACA;MACH,CAAC,MAAM;QACHA,QAAQ,CAAC,2DAA2D,CAAC;MACzE;IACL,CAAC,SAAS;MACNF,UAAU,CAAC,KAAK,CAAC;IACrB;EACJ,CAAC,EAAE,CAACG,MAAM,CAAC,CAAC,CAAC,CAAC;;EAEd;EACAlB,SAAS,CAAC,MAAM;IACZ6B,SAAS,CAAC,CAAC;EACf,CAAC,EAAE,CAACA,SAAS,CAAC,CAAC;;EAEf;EACA,MAAMQ,iBAAiB,GAAGA,CAAA,KAAM;IAC5BjB,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC;IACtBE,WAAW,CAAC,IAAI,CAAC;IACjBI,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC;IAClBY,MAAM,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EAC3B,CAAC;EAED,MAAMC,eAAe,GAAIC,IAAI,IAAK;IAC9BX,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAEU,IAAI,CAAC;IACtDrB,cAAc,CAACqB,IAAI,CAAC,CAAC,CAAC;IACtBnB,WAAW,CAAC,IAAI,CAAC;IACjBI,YAAY,CAAC,EAAE,CAAC;IAChBY,MAAM,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;EACzB,CAAC;EAED,MAAMG,gBAAgB,GAAGA,CAAA,KAAM;IAC3BtB,cAAc,CAAC,IAAI,CAAC;IACpBE,WAAW,CAAC,KAAK,CAAC;IAClBI,YAAY,CAAC,EAAE,CAAC;IAChBI,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC;EACtD,CAAC;;EAED;EACA;EACA,MAAMY,gBAAgB,GAAG,MAAOC,OAAO,IAAK;IACxCpB,cAAc,CAAC,IAAI,CAAC;IACpBE,YAAY,CAAC,EAAE,CAAC;IAChBI,OAAO,CAACC,GAAG,CAAC,wDAAwD,CAAC,CAACZ,WAAW,GAAG,EAAEyB,OAAO,CAAC;IAC9F,IAAI;MACA,IAAIC,OAAO,GAAG,EAAE;MAChB,IAAI1B,WAAW,EAAE;QACb;QACAW,OAAO,CAACC,GAAG,CAAC,sDAAsDZ,WAAW,CAAC2B,EAAE,EAAE,CAAC;QACnF,MAAM1C,UAAU,CAACe,WAAW,CAAC2B,EAAE,EAAEF,OAAO,CAAC;QACzCC,OAAO,GAAG,4BAA4B;MAC1C,CAAC,MAAM;QACH;QACAf,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC;QACzD,MAAM5B,UAAU,CAACyC,OAAO,CAAC;QACzBC,OAAO,GAAG,4BAA4B;MAC1C;MACAE,KAAK,CAACF,OAAO,CAAC,CAAC,CAAC;MAChB;MACAvB,WAAW,CAAC,KAAK,CAAC;MAClBF,cAAc,CAAC,IAAI,CAAC;MACpBS,SAAS,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,OAAOK,GAAG,EAAE;MAAA,IAAAc,aAAA,EAAAC,kBAAA;MACVnB,OAAO,CAACd,KAAK,CAAC,iCAAiCG,WAAW,GAAG,QAAQ,GAAG,QAAQ,QAAQ,EAAEe,GAAG,CAAC;MAC9F;MACAR,YAAY,CAAC,EAAAsB,aAAA,GAAAd,GAAG,CAACC,QAAQ,cAAAa,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcf,IAAI,cAAAgB,kBAAA,uBAAlBA,kBAAA,CAAoBJ,OAAO,KAAI,2BAA2B1B,WAAW,GAAG,UAAU,GAAG,UAAU,YAAY,CAAC;IAC7H,CAAC,SAAS;MACNK,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC;IAC3B;EACJ,CAAC;;EAEA;EACD,MAAM0B,gBAAgB,GAAG,MAAAA,CAAOC,MAAM,EAAEC,SAAS,KAAK;IAClDxB,gBAAgB,CAACuB,MAAM,CAAC,CAAC,CAAC;IAC1BlC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;IACda,OAAO,CAACC,GAAG,CAAC,qDAAqDoB,MAAM,YAAYC,SAAS,EAAE,CAAC;;IAE/F;IACA,IAAI,CAACd,MAAM,CAACe,OAAO,CAAC,8CAA8CD,SAAS,kCAAkC,CAAC,EAAE;MAC5GxB,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;MACxBE,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC;MAC5D;IACJ;IAEA,IAAI;MACA,MAAM1B,UAAU,CAAC8C,MAAM,CAAC,CAAC,CAAC;MAC1BJ,KAAK,CAAC,SAASK,SAAS,yBAAyB,CAAC;MAClDvB,SAAS,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,OAAOK,GAAG,EAAE;MACTJ,OAAO,CAACd,KAAK,CAAC,gDAAgDmC,MAAM,GAAG,EAAEjB,GAAG,CAAC;MAC7E;MACA,IAAIA,GAAG,CAACC,QAAQ,IAAID,GAAG,CAACC,QAAQ,CAACC,MAAM,KAAK,GAAG,EAAE;QAC5CnB,QAAQ,CAACiB,GAAG,CAACC,QAAQ,CAACF,IAAI,CAACY,OAAO,IAAI,kBAAkBO,SAAS,kEAAkE,CAAC;MACzI,CAAC,MAAM;QAAA,IAAAE,cAAA,EAAAC,mBAAA;QACF;QACAtC,QAAQ,CAAC,EAAAqC,cAAA,GAAApB,GAAG,CAACC,QAAQ,cAAAmB,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcrB,IAAI,cAAAsB,mBAAA,uBAAlBA,mBAAA,CAAoBV,OAAO,KAAI,0BAA0BO,SAAS,sBAAsB,CAAC;MACvG;IACL,CAAC,SAAS;MACNxB,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;IAC5B;EACJ,CAAC;;EAGD;EACA;EACA,IAAId,OAAO,EAAE,oBAAOL,OAAA;IAAK+C,SAAS,EAAC,SAAS;IAAAC,QAAA,EAAC;EAAoB;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAK,CAAC;EAEvE,oBACIpD,OAAA;IAAK+C,SAAS,EAAC,WAAW;IAAAC,QAAA,gBACtBhD,OAAA;MAAAgD,QAAA,EAAI;IAAe;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAEvB7C,KAAK,iBAAIP,OAAA;MAAG+C,SAAS,EAAC,eAAe;MAAAC,QAAA,EAAEzC;IAAK;MAAA0C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAGjD,CAACxC,QAAQ,iBACLZ,OAAA;MAAQqD,OAAO,EAAEzB,iBAAkB;MAAC0B,KAAK,EAAE;QAAEC,YAAY,EAAE;MAAO,CAAE;MAAAP,QAAA,EAAC;IAAc;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAC/F,EAWAxC,QAAQ,iBACLZ,OAAA,CAACF,QAAQ;MACLkC,IAAI,EAAEtB,WAAY;MAClB8C,QAAQ,EAAEtB,gBAAiB;MAC3BuB,QAAQ,EAAExB,gBAAiB;MAC3B5B,OAAO,EAAES,WAAY;MACrBP,KAAK,EAAES;IAAU;MAAAiC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACnB,CACL,eAGDpD,OAAA;MAAAgD,QAAA,EAAI;IAAc;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EACtBjD,KAAK,CAACuD,MAAM,KAAK,CAAC,IAAI,CAACrD,OAAO,gBAC3BL,OAAA;MAAAgD,QAAA,EAAG;IAAgD;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,gBAEvDpD,OAAA;MAAAgD,QAAA,gBAEIhD,OAAA;QAAAgD,QAAA,eACIhD,OAAA;UAAAgD,QAAA,gBACIhD,OAAA;YAAAgD,QAAA,EAAI;UAAE;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACXpD,OAAA;YAAAgD,QAAA,EAAI;UAAK;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACdpD,OAAA;YAAAgD,QAAA,EAAI;UAAM;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACfpD,OAAA;YAAAgD,QAAA,EAAI;UAAQ;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACjBpD,OAAA;YAAAgD,QAAA,EAAI;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACZpD,OAAA;YAAAgD,QAAA,EAAI;UAAK;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACdpD,OAAA;YAAAgD,QAAA,EAAI;UAAO;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChB;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC,eAERpD,OAAA;QAAAgD,QAAA,EAEK7C,KAAK,CAACwD,GAAG,CAAC3B,IAAI,iBACXhC,OAAA;UAAAgD,QAAA,gBACIhD,OAAA;YAAAgD,QAAA,EAAKhB,IAAI,CAACK;UAAE;YAAAY,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eAClBpD,OAAA;YAAAgD,QAAA,EAAKhB,IAAI,CAAC4B;UAAK;YAAAX,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACrBpD,OAAA;YAAAgD,QAAA,EAAKhB,IAAI,CAAC6B,MAAM,IAAI;UAAK;YAAAZ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eAE/BpD,OAAA;YAAAgD,QAAA,EAAKhB,IAAI,CAAC8B,aAAa,IAAI;UAAK;YAAAb,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACtCpD,OAAA;YAAAgD,QAAA,EAAKhB,IAAI,CAAC+B;UAAQ;YAAAd,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eAExBpD,OAAA;YAAAgD,QAAA,EAAKhB,IAAI,CAACgC,KAAK,IAAI,IAAI,GAAG,IAAIC,MAAM,CAACjC,IAAI,CAACgC,KAAK,CAAC,CAACE,OAAO,CAAC,CAAC,CAAC,EAAE,GAAG;UAAK;YAAAjB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eAC3EpD,OAAA;YAAAgD,QAAA,gBAEIhD,OAAA;cACI+C,SAAS,EAAC,WAAW;cACrBM,OAAO,EAAEA,CAAA,KAAMtB,eAAe,CAACC,IAAI;cACnC;cAAA;cACAmC,QAAQ,EAAEjD,aAAa,KAAKc,IAAI,CAACK,EAAE,IAAIvB,WAAY;cACnDwC,KAAK,EAAE;gBAAEc,WAAW,EAAE;cAAM,CAAE;cAAApB,QAAA,EACjC;YAED;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eAETpD,OAAA;cACI+C,SAAS,EAAC,QAAQ;cAClBM,OAAO,EAAEA,CAAA,KAAMZ,gBAAgB,CAACT,IAAI,CAACK,EAAE,EAAEL,IAAI,CAAC4B,KAAK;cACnD;cAAA;cACAO,QAAQ,EAAEjD,aAAa,KAAKc,IAAI,CAACK,EAAE,IAAIvB,WAAY;cAAAkC,QAAA,EAGlD9B,aAAa,KAAKc,IAAI,CAACK,EAAE,GAAG,aAAa,GAAG;YAAQ;cAAAY,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjD,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACT,CAAC;QAAA,GA9BApB,IAAI,CAACK,EAAE;UAAAY,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OA+BZ,CACP;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CACV,eAEDpD,OAAA;MAAOqE,GAAG;MAAArB,QAAA,EAAE;AACxB;AACA;AACA;AACA;AACA;AACA;IAAa;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACT,CAAC;AAEd;AAAClD,EAAA,CA9OQD,kBAAkB;EAAA,QAOJJ,OAAO;AAAA;AAAAyE,EAAA,GAPrBrE,kBAAkB;AAgP3B,eAAeA,kBAAkB;AAAC,IAAAqE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}